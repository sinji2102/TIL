# [241122] Funnel êµ¬ì¡° 2íƒ„

</br>

## ğŸ¤” ë¬¸ì œ ìƒí™©

ì–´ì œ Funnel êµ¬ì¡°ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ë‹¤. ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ê°€ ë³´ë‹¤ëŠ” ì™œ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•´ ì•Œì•„ë´ì„œ, ì˜¤ëŠ˜ì€ ê°„ë‹¨í•˜ê²Œ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ ì˜ˆì œë¥¼ í†µí•´ ì•Œì•„ë³¼ ì˜ˆì •ì´ë‹¤.

</br>

## ğŸ€ Today I Learn

### êµ¬ì¡° í™•ì¸

![image](https://github.com/user-attachments/assets/2da33729-b55a-437d-8042-629b2569a152)

íšŒì› ê°€ì…ì— í•„ìš”í•œ ë‹¨ê³„ëŠ” ì´ë¦„, í•™ë²ˆ, í•™êµ ì´ë©”ì¼ + ì¸ì¦ë²ˆí˜¸, ë¹„ë°€ë²ˆí˜¸ + ë¹„ë°€ë²ˆí˜¸ ì¬í™•ì¸ìœ¼ë¡œ ì´ ë„¤ ê°œì˜ í˜ì´ì§€ê°€ í•„ìš”í•˜ë‹¤.

### useFunnel

```
// useFunnel.tsx

import React, { ReactElement, ReactNode, useState } from 'react';

export interface StepProps {
  name: string;
  children: ReactNode;
}

export interface FunnelProps {
  children: Array<ReactElement<StepProps>>;
}

export const useFunnel = (defaultStep: string) => {
  // stateë¥¼ í†µí•´ í˜„ì¬ ìŠ¤í…ì„ ê´€ë¦¬
  // setStep í•¨ìˆ˜ë¥¼ í†µí•´ í˜„ì¬ ìŠ¤í…ì„ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
  const [step, setStep] = useState(defaultStep);

  // ê° ë‹¨ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” Step ì»´í¬ë„ŒíŠ¸
  // childrenì„ í†µí•´ ê° ìŠ¤í…ì˜ ì»¨í…ì¸ ë¥¼ ë Œë”ë§ í•œë‹¤.
  const Step = (props: StepProps): ReactElement => {
    return <>{props.children}</>;
  };

  // ì—¬ëŸ¬ ë‹¨ê³„ì˜ Step ì»´í¬ë„ŒíŠ¸ ì¤‘ í˜„ì¬ í™œì„±í™”ëœ ìŠ¤í…ì„ ë Œë”ë§í•˜ëŠ” Funnel
  // findë¥¼ í†µí•´ Step ì¤‘ í˜„ì¬ Stepì„ ì°¾ì•„ ë Œë”ë§
  const Funnel = ({ children }: FunnelProps) => {
    const targetStep = children.find((childStep) => childStep.props.name === step);

    return <>{targetStep}</>;
  };

  return { Funnel, Step, setStep, currentStep: step } as const;
};
```

### ì‚¬ìš©

ê° ìŠ¤í…ì— í•´ë‹¹í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ì£¼ê³ , ì´ë¥¼ Step ì»´í¬ë„ŒíŠ¸ë¡œ ê°ì‹¼ ë’¤ Funnel ì»´í¬ë„ŒíŠ¸ë¡œ ë¬¶ì–´ì¤€ë‹¤.

```
// ProfileSetup.tsx

import React from 'react';
// type ì§€ì •ì„ ìœ„í•œ import
import { FunnelProps, StepProps } from '../../../hooks/useFunnel';
// ì´ ì™¸ import ...

export interface ProfileSetupInterface {
  steps: string[];
  nextClickHandler: (nextStep: string) => void;
  Funnel: React.ComponentType<FunnelProps>;
  Step: React.ComponentType<StepProps>;
}

const ProfileSetup = ({ steps, nextClickHandler, Funnel, Step }: ProfileSetupInterface) => {
  return (
    <SetupPageLayout>
      <Funnel>
        <Step name='ì´ë¦„'>
          <SetupName onNext={() => nextClickHandler(steps[1])} />
        </Step>

        <Step name='í•™ë²ˆ'>
          <SetupNumber onNext={() => nextClickHandler(steps[2])} />
        </Step>

        <Step name='ì´ë©”ì¼ ì¸ì¦'>
          <SetupEmail onNext={() => nextClickHandler(steps[3])} />
        </Step>

        <Step name='ë¹„ë°€ë²ˆí˜¸ ì„¤ì •'>
          <SetupPassword />
        </Step>
      </Funnel>
    </SetupPageLayout>
  );
};

export default ProfileSetup;
```

ì „ì²´ ë‹¨ê³„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë°°ì—´ stepsì™€ Funnel / Step ì»´í¬ë„ŒíŠ¸, ë‹¤ìŒ ìŠ¤í…ìœ¼ë¡œ ë„˜ì–´ê°€ëŠ” í•¨ìˆ˜ nextClickHandlerëŠ” ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì¸ Page ì»´í¬ë„ŒíŠ¸ì—ì„œ propsë¡œ ì „ë‹¬ ë°›ë„ë¡ í•œë‹¤.

ë§ˆì§€ë§‰ ë‹¨ê³„ì¸ 'ë¹„ë°€ë²ˆí˜¸' ë‹¨ê³„ì—ì„œëŠ” onNext propsë¥¼ ì „ë‹¬í•˜ì§€ ì•ŠëŠ”ë°, ì´ëŠ” ë§ˆì§€ë§‰ ë‹¨ê³„ì—ì„œëŠ” ë‹¤ìŒ ì ˆì°¨ë¡œ ë„˜ì–´ê°ˆ í•„ìš”ê°€ ì—†ê³  formì„ submit í•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤.

### í˜ì´ì§€

```
// SignUpPage.tsx

import React, { useState } from 'react';
import { useFunnel } from '@/hooks/useFunnel';
// react hook formì„ ì‚¬ìš©í•œ form ì»´í¬ë„ŒíŠ¸
import GenericForm from '@/components/public/form/GenericForm';
// ì´ ì™¸ import ...

// ì „ì²´ ìŠ¤í…ì„ ë‹´ì€ ë°°ì—´
const steps = [
  'ì´ë¦„',
  'í•™ë²ˆ',
  'ì´ë©”ì¼ ì¸ì¦',
  'ë¹„ë°€ë²ˆí˜¸ ì„¤ì •',
];

const SignUpPage = () => {
  const { submitSignup } = useSignup();
  const { Funnel, Step, setStep } = useFunnel(steps[0]);
  // ì´ ì™¸ state ...

  const nextClickHandler = // ... ë¡œì§

  const prevClickHandler = // ... ë¡œì§

  return (
    <>
      <PageHeader title='íšŒì›ê°€ì…' onClick={prevClickHandler} />
      <PageLayout>
        <GenericForm<ProfileSetupDataInterface>
          formOptions={{ mode: 'onChange' }}
          onSubmit={submitSignup}
        >
          <ProfileSetup
            steps={steps}
            nextClickHandler={nextClickHandler}
            Funnel={Funnel}
            Step={Step}
          />
        </GenericForm>
      </PageLayout>
    </>
  );
};

export default SignUpPage;
```

</br>

## âš¡ ë§ˆë¬´ë¦¬

ë‹¤ë¥¸ ë¶„ì˜ ì½”ë“œë¥¼ ë³´ê³  ê³µë¶€í•´ì„œ ì„ì‹œë¡œ ì‘ì„±í•œ ì½”ë“œì§€ë§Œ ì½”ë“œë¥¼ ëœ¯ì–´ë³´ë©° Funnel êµ¬ì¡°ë¥¼ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ë©´ ì¢‹ì„ì§€ ê³ ë¯¼í•´ë³¸ ì¢‹ì€ ê¸°íšŒê°€ ë˜ì—ˆë‹¤. ì¼ë‹¨ ìŠ¤í”„ë¦°íŠ¸ê°€ ë„ˆë¬´ ë°œë“±ì´ íŠ€ê²¨ì§€ê³  ìˆì–´ì„œ...!! ì‹œí—˜ ê¸°ê°„ ë™ì•ˆ í•œ ë²ˆ êµ¬í˜„í•´ë´ì•¼ê² ë‹¤.

í•´ë‹¹í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•œ í›„ í†µê³¼í•œ ê²½ìš°ì—ë§Œ ë²„íŠ¼ì„ í™œì„±í™” ì‹œí‚¤ëŠ” ê²ƒë„ ì¢‹ì€ ë°©ë²•ì¸ ê²ƒ ê°™ë‹¤. ë¹Œë¦´ê²Œ íŒŒì´íŒ…... ğŸ’™ ì—‰ì—‰ ìš¸ë©´ì„œ ë¹„íŠ¸ ê°œë°œí•˜ëŸ¬ ê°€ì•¼ê² ë‹¤...

</br>

---

ì°¸ê³  ìë£Œ
</br>
[í¼ë„ì„ í†µí•œ ë§ì€ í˜ì´ì§€ ê´€ë¦¬í•˜ê¸° (Feat. useFunnel, React-Hook-Form)](https://velog.io/@hoonnn/%ED%8D%BC%EB%84%90%EC%9D%84-%ED%86%B5%ED%95%9C-%EB%A7%8E%EC%9D%80-%ED%8E%98%EC%9D%B4%EC%A7%80-%EA%B4%80%EB%A6%AC%ED%95%98%EA%B8%B0-Feat.-useFunnel-React-Hook-Form)
